{"ast":null,"code":"import Router from 'next/router';\nimport axios from 'axios';\nimport { AUTHENTICATE, DEAUTHENTICATE, USER } from '../types';\nimport { API } from '../../config';\nimport { setCookie, removeCookie } from '../../utils/cookie';\n\nvar register = function register(_ref, type) {\n  var name = _ref.name,\n      email = _ref.email,\n      password = _ref.password;\n\n  if (type !== 'register') {\n    throw new Error('salah');\n  }\n\n  return function (dispatch) {\n    axios.post(\"\".concat(API, \"/auth/\").concat(type), {\n      name: name,\n      email: email,\n      password: password\n    }).then(function (response) {\n      Router.push('/');\n      console.log(response.data.meta.message);\n    })[\"catch\"](function (err) {\n      switch (error.response.status) {\n        case 422:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 401:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 500:\n          alert('Interval server error! Try again!');\n          break;\n\n        default:\n          alert(error.response.data.meta.message);\n          break;\n      }\n    });\n  };\n}; // ambil token dari api masukin ke cookie\n\n\nvar authenticate = function authenticate(_ref2, type) {\n  var email_id = _ref2.email_id,\n      password = _ref2.password;\n\n  if (type !== 'login') {\n    throw new Error('Wrong API call!');\n  }\n\n  return function (dispatch) {\n    console.log(email_id);\n    axios.post(\"\".concat(API, \"/\").concat(type), {\n      email_id: email_id,\n      password: password\n    }).then(function (response) {\n      console.log(response.data.data.user.token);\n      setCookie('token', response.data.data.user.token);\n      Router.push('/users');\n      dispatch({\n        type: AUTHENTICATE,\n        payload: response.data.data.user.token\n      });\n    })[\"catch\"](function (err) {\n      console.log(err);\n\n      switch (error.response.status) {\n        case 422:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 401:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 500:\n          alert('Interval server error! Try again!');\n          break;\n\n        default:\n          alert(error.response.data.meta.message);\n          break;\n      }\n    });\n  };\n}; // ambil token dr cookie\n\n\nvar reauthenticate = function reauthenticate(token) {\n  return function (dispatch) {\n    dispatch({\n      type: AUTHENTICATE,\n      payload: token\n    });\n  };\n}; // hapus token\n\n\nvar deauthenticate = function deauthenticate() {\n  return function (dispatch) {\n    removeCookie('token');\n    Router.push('/');\n    dispatch({\n      type: DEAUTHENTICATE\n    });\n  };\n};\n\nvar getUser = function getUser(_ref3, type) {\n  var token = _ref3.token;\n  console.log(token);\n  return function (dispatch) {\n    axios.get(\"\".concat(API, \"/\").concat(type), {\n      headers: {\n        \"Authorization\": \"bearer \" + token\n      }\n    }).then(function (response) {\n      dispatch({\n        type: USER,\n        payload: response.data.data.user\n      });\n    })[\"catch\"](function (error) {\n      switch (error.response.status) {\n        case 401:\n          Router.push('/');\n          break;\n\n        case 422:\n          alert(error.response.data.meta.message);\n          break;\n\n        case 500:\n          alert('server error');\n\n        case 503:\n          alert(error.response.data.meta.message);\n          Router.push('/');\n          break;\n\n        default:\n          alert(error.response.data.meta.message);\n          break;\n      }\n    });\n  };\n};\n\nexport default {\n  register: register,\n  authenticate: authenticate,\n  reauthenticate: reauthenticate,\n  deauthenticate: deauthenticate,\n  getUser: getUser\n};","map":{"version":3,"sources":["D:/Koomik/fe_pokekoo/redux/actions/authact.jsx"],"names":["Router","axios","AUTHENTICATE","DEAUTHENTICATE","USER","API","setCookie","removeCookie","register","type","name","email","password","Error","dispatch","post","then","response","push","console","log","data","meta","message","err","error","status","alert","authenticate","email_id","user","token","payload","reauthenticate","deauthenticate","getUser","get","headers"],"mappings":"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","sourcesContent":["import Router from 'next/router';\r\nimport axios from 'axios';\r\nimport { AUTHENTICATE, DEAUTHENTICATE, USER } from '../types';\r\nimport { API } from '../../config';\r\nimport { setCookie, removeCookie } from '../../utils/cookie';\r\n\r\n\r\nconst register = ({ name, email, password }, type) => {\r\n  if (type !== 'register') {\r\n    throw new Error('salah');\r\n  }\r\n  return (dispatch) => {\r\n    axios.post(`${API}/auth/${type}`, {name, email, password })\r\n      .then((response) => {\r\n        Router.push('/');\r\n        console.log(response.data.meta.message);\r\n      })\r\n      .catch((err) => {\r\n        switch (error.response.status) {\r\n          case 422:\r\n          alert(error.response.data.meta.message);\r\n            break;\r\n          case 401:\r\n          alert(error.response.data.meta.message);\r\n            break;\r\n          case 500:\r\n          alert('Interval server error! Try again!');\r\n            break;\r\n          default:\r\n          alert(error.response.data.meta.message);\r\n            break;\r\n        }\r\n      });\r\n  };\r\n};\r\n// ambil token dari api masukin ke cookie\r\nconst authenticate = ({ email_id, password }, type) => {\r\n  if (type !== 'login') {\r\n    throw new Error('Wrong API call!');\r\n  }\r\n  return (dispatch) => {\r\n    console.log(email_id)\r\n    axios.post(`${API}/${type}`, { email_id, password })\r\n      .then((response) => {\r\n        console.log(response.data.data.user.token);\r\n        setCookie('token', response.data.data.user.token);\r\n        Router.push('/users');\r\n        dispatch({type: AUTHENTICATE, payload: response.data.data.user.token});\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n        switch (error.response.status) {\r\n          case 422:\r\n          alert(error.response.data.meta.message);\r\n            break;\r\n          case 401:\r\n          alert(error.response.data.meta.message);\r\n            break;\r\n          case 500:\r\n          alert('Interval server error! Try again!');\r\n            break;\r\n          default:\r\n          alert(error.response.data.meta.message);\r\n            break;\r\n        }\r\n\r\n      });\r\n  };\r\n};\r\n\r\n// ambil token dr cookie\r\nconst reauthenticate = (token) => {\r\n  return (dispatch) => {\r\n    dispatch({type: AUTHENTICATE, payload: token});\r\n  };\r\n};\r\n\r\n// hapus token\r\nconst deauthenticate = () => {\r\n  return (dispatch) => {\r\n    removeCookie('token');\r\n    Router.push('/');\r\n    dispatch({type: DEAUTHENTICATE});\r\n  };\r\n};\r\n\r\nconst getUser = ({ token }, type) => {\r\n  console.log(token)\r\n  return (dispatch) => {\r\n    axios.get(`${API}/${type}`,{headers: {\r\n      \"Authorization\" : \"bearer \" + token\r\n    }\r\n  })\r\n      .then((response) => {\r\n        dispatch({ type: USER, payload: response.data.data.user });\r\n      })\r\n      .catch((error) => {\r\n        switch (error.response.status) {\r\n          case 401:\r\n            Router.push('/');\r\n            break;\r\n          case 422:\r\n            alert(error.response.data.meta.message);\r\n            break;\r\n          case 500:\r\n          alert('server error');\r\n          case 503:\r\n          alert(error.response.data.meta.message);\r\n          Router.push('/');\r\n            break;\r\n          default:\r\n          alert(error.response.data.meta.message);\r\n            break;\r\n        }\r\n      });\r\n  };\r\n};\r\n\r\n\r\nexport default {\r\n  register,\r\n  authenticate,\r\n  reauthenticate,\r\n  deauthenticate,\r\n  getUser,\r\n};"]},"metadata":{},"sourceType":"module"}